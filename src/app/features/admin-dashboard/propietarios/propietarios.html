<div class="airbnb-home">
  <!-- Top Filters -->
  <div class="categories-border">
    <div class="categories-container">
      <div class="header-title">
        <h1>Propietarios</h1>
        <p>Administra los usuarios registrados</p>
      </div>

      <div class="filters-actions">

        <!-- Search -->
        <div class="search-wrapper">
          <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input type="text" placeholder="Buscar..." [(ngModel)]="searchTerm" class="search-input" />
        </div>

        <!-- City Filter REMOVED -->

        <div class="nav-links">
          <a routerLink="/admin/propietarios" class="nav-link active">Propietarios</a>
          <a routerLink="/admin/propiedades" class="nav-link">Propiedades</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="listings-grid">

      <div *ngFor="let landlord of filteredLandlords" class="listing-card landlord-profile-card">

        <!-- Header: Avatar & Name -->
        <div class="card-header-profile">
          <div class="avatar-circle">
            <span class="avatar-emoji">{{ landlord.photo }}</span>
          </div>
          <div class="profile-title">
            <h3 class="landlord-name">{{ landlord.name }}</h3>
            <span class="landlord-role">Propietario</span>
          </div>
        </div>

        <div class="card-divider"></div>

        <!-- Body: Contact Info & Stats -->
        <div class="card-body-profile">

          <div class="info-row">
            <span class="info-icon">ğŸ“§</span>
            <span class="info-text" [title]="landlord.email">{{ landlord.email }}</span>
          </div>

          <div class="info-row">
            <span class="info-icon">ğŸ“</span>
            <span class="info-text">{{ landlord.phone || 'Sin telÃ©fono' }}</span>
          </div>

          <div class="stats-row">
            <div class="stat-item">
              <span class="stat-value">{{ landlord.properties }}</span>
              <span class="stat-label">Propiedades</span>
            </div>
          </div>

        </div>

        <!-- Footer: Actions -->
        <div class="card-footer-actions">
          <button class="btn-action-icon message" (click)="sendMessage(landlord)" title="Enviar Mensaje">
            ğŸ’¬
          </button>
          <button class="btn-action-icon view" (click)="viewProperties(landlord)" title="Ver Propiedades">
            ğŸ 
          </button>
          <button class="btn-action-icon delete" (click)="deleteOwner(landlord)" title="Eliminar Usuario">
            ğŸ—‘ï¸
          </button>
        </div>

      </div>
    </div>

    <div *ngIf="filteredLandlords.length === 0" class="no-results">
      <p>No se encontraron propietarios.</p>
    </div>
  </main>

  <!-- Owner Properties Modal -->
  <div *ngIf="showOwnerProperties" class="modal-overlay" (click)="closeOwnerProperties()">
    <div class="modal-content properties-modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-name">Propiedades del Usuario</h2>
        <button class="close-button" (click)="closeOwnerProperties()">âœ•</button>
      </div>

      <div class="modal-body">
        <div *ngIf="ownerProperties.length === 0" class="no-results">
          <p>Este usuario no tiene propiedades registradas.</p>
        </div>

        <div class="mini-listings-grid">
          <div *ngFor="let prop of ownerProperties" class="mini-listing-card">
            <div class="listing-image-container">
              <img [src]="getImageUrl(prop.fotos && prop.fotos.length > 0 ? prop.fotos[0].url : '')" [alt]="prop.titulo"
                class="listing-image">
              <span class="status-badge" [class.approved]="prop.aprobada" [class.pending]="!prop.aprobada">
                {{ prop.aprobada ? 'Aprobada' : 'Pendiente' }}
              </span>
            </div>
            <div class="listing-info">
              <h4>{{ prop.titulo }}</h4>
              <p style="font-weight: 600; font-size: 13px; color: #444; margin-bottom: 2px;">
                {{ prop.tipo === 'Depa' ? 'Departamento' : prop.tipo }}
              </p>
              <p>{{ prop.distrito }}, {{ prop.departamento }}</p>
              <p class="price">S/{{ prop.precioMensual }} / mes</p>
              <button class="status-toggle-btn" [class.rented]="prop.alquilado"
                (click)="toggleRentStatus(prop, $event)">
                {{ prop.alquilado ? 'Alquilado ğŸ”´' : 'Disponible ğŸŸ¢' }}
              </button>
              <button class="delete-prop-btn" (click)="deleteProperty(prop, $event)">
                ğŸ—‘ï¸ Eliminar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>